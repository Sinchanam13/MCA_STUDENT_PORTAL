<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecturer Login Page</title>

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        display: ["Lexend", "sans-serif"]
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-background-light font-display">
    <div class="flex min-h-screen">
        <!-- Left Image -->
        <div class="hidden lg:flex w-1/2 bg-cover bg-center"
            style="background-image:url('https://lh3.googleusercontent.com/aida-public/AB6AXuARrGwSjTtm2H1DrEx-pCUmY0zmWCdazVnDmPP65G_QDiOXCtBN9VJXsPcJOVRlDF5_PBPEG4oDW5hi1tWRyYd4dPRB1n8PKu64sFnL62cdrhWd-RLLF7tyhE33Oh80es6Y8dJNmxj0e-722zT1Tl11BavmX8TsIcxW6S_RgYXDVQFgGJaW-tg4tWfGrlJJwtzqd4LSKMZoz2upVMAKHWbZZgCQDyjTPAisOTu1hfVyBbO5yrclPQj-yavPbaH-YvLjY5Hi0Q-3Nx8t')">
        </div>

        <!-- Right Login -->
        <div class="flex w-full lg:w-1/2 items-center justify-center p-10">
            <div class="w-full max-w-md space-y-8">

                <div>
                    <h1 class="text-3xl font-bold">Welcome Back</h1>
                    <p class="text-gray-500">Please enter your email to sign in.</p>
                </div>

                <!-- Email -->
                <div>
                    <label class="block font-medium mb-2">Email Address</label>
                    <input id="email" type="email"
                        class="w-full h-14 rounded-lg border p-4 focus:ring-2 focus:ring-primary"
                        placeholder="yourname@rnsit.ac.in" />
                </div>

                <!-- Submit -->
                <button onclick="loginLecturer()"
                    class="w-full h-14 rounded-lg bg-primary text-white font-semibold hover:bg-blue-600">
                    Sign In
                </button>

                <!-- Google -->
                <button onclick="loginWithGoogle()"
                    class="w-full h-14 rounded-lg bg-gray-200 font-medium flex items-center justify-center gap-2 hover:bg-gray-300">
                    <svg class="w-5 h-5" viewBox="0 0 24 24">
                        <path fill="#EA4335"
                            d="M12 10.2v3.6h5.1c-.2 1.2-1.4 3.6-5.1 3.6-3.1 0-5.7-2.6-5.7-5.7S8.9 6 12 6c1.8 0 3 .7 3.7 1.4l2.5-2.4C16.6 3.4 14.5 2.4 12 2.4 6.9 2.4 2.8 6.5 2.8 11.7S6.9 21 12 21c6.9 0 8.6-4.8 8.6-7.2 0-.5-.1-.8-.1-1.1H12z" />
                    </svg>
                    Sign in with Google
                </button>

            </div>
        </div>
    </div>

    <!-- Firebase Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAXwj3oHDypUhiyoaJwVxpv5bSdcEcJXKI",
            authDomain: "department-d3659.firebaseapp.com",
            projectId: "department-d3659",
            appId: "1:722426252948:web:930f2b23ec8b310502ae81"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ðŸ”¹ EMAIL-ONLY LOGIN (without approval check)
        window.loginLecturer = async function () {
            const email = document.getElementById("email").value.trim().toLowerCase();

            if (!email) {
                alert("Please enter email");
                return;
            }

            if (!email.endsWith("@rnsit.ac.in")) {
                alert("Only college email allowed");
                return;
            }

            try {
                const docRef = doc(db, "lecturers", email);
                const snap = await getDoc(docRef);

                if (!snap.exists()) {
                    alert("Email not registered");
                    return;
                }

                // âœ… Approval check removed
                localStorage.setItem("role", "lecturer");
                localStorage.setItem("email", email);
                onLecturerLoginSuccess();


            } catch (err) {
                console.error(err);
                alert("Login failed");
            }
        };

        // ðŸ”¹ GOOGLE SIGN-IN (without approval check)
        window.loginWithGoogle = async function () {
            const provider = new GoogleAuthProvider();
            provider.setCustomParameters({ hd: "rnsit.ac.in" });

            try {
                const result = await signInWithPopup(auth, provider);
                const email = result.user.email.toLowerCase();

                const docRef = doc(db, "lecturers", email);
                const snap = await getDoc(docRef);

                if (!snap.exists()) {
                    alert("Email not registered");
                    return;
                }

                localStorage.setItem("role", "lecturer");
                localStorage.setItem("email", email);
                onLecturerLoginSuccess();


            } catch (err) {
                console.error(err);
                alert("Google sign-in failed");
            }
        };
    </script>
    <script>
        function onLecturerLoginSuccess() {
            sessionStorage.setItem("userType", "lecturer");
            window.location.href = "home.html";
        }
    </script>


</body>

</html>